<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revision Tracker | NEET 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #4b6cb7;
            --secondary-color: #182848;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #f5f7fa;
            --dark-color: #2c3e50;
            --border-radius: 12px;
            --box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            transition: var(--transition);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Theme colors */
        body.theme-light-blue {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --primary-color: #4b6cb7;
            --secondary-color: #182848;
        }
        
        body.theme-light-green {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            --primary-color: #43a047;
            --secondary-color: #1b5e20;
        }
        
        body.theme-light-pink {
            background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
            --primary-color: #d81b60;
            --secondary-color: #880e4f;
        }
        
        body.theme-light-purple {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            --primary-color: #8e24aa;
            --secondary-color: #4a148c;
        }
        
        body.theme-light-orange {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            --primary-color: #f57c00;
            --secondary-color: #e65100;
        }
        
        body.theme-black-white {
            background: linear-gradient(135deg, #f8f8f8 0%, #e0e0e0 100%);
            --primary-color: #333333;
            --secondary-color: #000000;
            --success-color: #4a4a4a;
            --warning-color: #666666;
            --danger-color: #222222;
            --light-color: #f5f5f5;
            --dark-color: #111111;
            color: #222;
        }
        
        body.theme-black-white .card {
            background: #fafafa;
            border: 1px solid #ddd;
        }
        
        body.theme-black-white .chapter-item,
        body.theme-black-white .revision-item {
            background: #f0f0f0;
            border-color: #ccc;
        }
        
        body.theme-black-white .stat-card {
            background: #f5f5f5;
        }
        
        body.theme-black-white .subject-tab {
            background: #e8e8e8;
            color: #333;
        }
        
        body.theme-black-white .subject-tab.active {
            background: #333;
            color: #f5f5f5;
        }
        
        body.theme-black-white .btn-primary {
            background: #444;
        }
        
        body.theme-black-white .btn-primary:hover {
            background: #222;
        }
        
        /* Header styles - Smaller size */
        header {
            text-align: center;
            padding: 15px 20px;
            margin-bottom: 25px;
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            position: relative;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .header-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .theme-selector {
            position: relative;
        }
        
        .theme-dropdown {
            position: absolute;
            top: 40px;
            right: 0;
            background: white;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            min-width: 170px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .theme-dropdown.show {
            display: block;
        }
        
        .theme-option {
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }
        
        .theme-option:hover {
            background: #f0f0f0;
        }
        
        .theme-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .theme-light-blue .theme-color { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .theme-light-green .theme-color { background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); }
        .theme-light-pink .theme-color { background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%); }
        .theme-light-purple .theme-color { background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); }
        .theme-light-orange .theme-color { background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); }
        .theme-black-white .theme-color { background: linear-gradient(135deg, #f8f8f8 0%, #e0e0e0 100%); border: 1px solid #aaa; }
        
        .current-date {
            font-size: 1.1rem;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .neet-countdown {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 30px;
            display: inline-block;
            margin-top: 8px;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .neet-countdown .highlight {
            color: #ffeb3b;
            font-weight: 700;
        }
        
        /* Main layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 22px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            height: fit-content;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card h2 {
            color: var(--dark-color);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }
        
        .card h2 i {
            color: var(--primary-color);
        }
        
        /* Subject tabs */
        .subject-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .subject-tab {
            padding: 8px 18px;
            background: #f0f0f0;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            border: 2px solid transparent;
            font-size: 0.9rem;
        }
        
        .subject-tab:hover {
            background: #e0e0e0;
        }
        
        .subject-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--secondary-color);
        }
        
        .subject-tab.biology {
            border-left: 4px solid #2ecc71;
        }
        
        .subject-tab.chemistry {
            border-left: 4px solid #e74c3c;
        }
        
        .subject-tab.physics {
            border-left: 4px solid #3498db;
        }
        
        /* Chapters grid */
        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .chapter-item {
            background: #f8f9fa;
            border-left: 4px solid #95a5a6;
            padding: 16px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }
        
        .chapter-item:hover {
            background: #edf2f7;
        }
        
        .chapter-item.completed {
            border-left-color: var(--success-color);
            background: #f0f9f0;
        }
        
        .chapter-item.completed .chapter-name {
            opacity: 0.9;
        }
        
        .chapter-info {
            flex-grow: 1;
        }
        
        .chapter-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 8px;
        }
        
        .chapter-meta {
            font-size: 0.85rem;
            color: #666;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .chapter-subject {
            background: var(--primary-color);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
        }
        
        .chapter-actions {
            display: flex;
            gap: 8px;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .complete-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .complete-btn:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        
        .undo-btn {
            background: var(--warning-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 5px;
        }
        
        .undo-btn:hover {
            background: #d68910;
            transform: scale(1.05);
        }
        
        .revision-date {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        /* Button styles */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--secondary-color);
            transform: scale(1.03);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        /* Today's revisions and backlog */
        .today-revision-list, .backlog-list, .upcoming-revisions-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .revision-item {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .revision-item.missed {
            border-left-color: var(--danger-color);
        }
        
        .revision-item.completed {
            border-left-color: var(--success-color);
            opacity: 0.8;
        }
        
        .revision-badge {
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .revision-badge.missed {
            background: var(--danger-color);
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }
        
        .complete-revision-btn {
            background: var(--success-color);
            color: white;
        }
        
        .complete-revision-btn:hover {
            background: #27ae60;
        }
        
        .missed-revision-btn {
            background: var(--warning-color);
            color: white;
        }
        
        .missed-revision-btn:hover {
            background: #d68910;
        }
        
        /* Statistics section */
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.95rem;
        }
        
        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #888;
        }
        
        .empty-state i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* Instructions */
        .instructions {
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 30px 0;
            border-radius: var(--border-radius);
            font-size: 0.95rem;
        }
        
        .instructions h3 {
            margin-bottom: 15px;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .instructions ul {
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        /* Subject stats */
        .subject-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px 15px;
            background: #f0f7ff;
            border-radius: 8px;
        }
        
        .subject-stat {
            text-align: center;
        }
        
        .subject-stat-value {
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .subject-stat.biology .subject-stat-value {
            color: #2ecc71;
        }
        
        .subject-stat.chemistry .subject-stat-value {
            color: #e74c3c;
        }
        
        .subject-stat.physics .subject-stat-value {
            color: #3498db;
        }
        
        .subject-stat-label {
            font-size: 0.85rem;
            color: #666;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Modal for date-wise revision plan */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 18px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .close-modal {
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .modal-content {
            padding: 25px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .date-revision-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .date-revision-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid var(--primary-color);
        }
        
        .date-revision-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #ddd;
        }
        
        .revision-date-title {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .revision-count {
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .date-chapters-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .date-chapter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .date-chapter-item:last-child {
            border-bottom: none;
        }
        
        .date-chapter-subject {
            font-size: 0.8rem;
            background: #e9ecef;
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        /* Warning dialog */
        .warning-dialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .warning-dialog.active {
            opacity: 1;
            visibility: visible;
        }
        
        .warning-content {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s;
            text-align: center;
        }
        
        .warning-dialog.active .warning-content {
            transform: translateY(0);
        }
        
        .warning-icon {
            font-size: 3rem;
            color: var(--warning-color);
            margin-bottom: 15px;
        }
        
        .warning-text {
            margin-bottom: 25px;
            font-size: 1.1rem;
            line-height: 1.5;
            color: #333;
        }
        
        .warning-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .warning-btn {
            padding: 12px 25px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1rem;
            min-width: 120px;
        }
        
        .warning-btn.cancel {
            background: #f0f0f0;
            color: #333;
        }
        
        .warning-btn.cancel:hover {
            background: #e0e0e0;
        }
        
        .warning-btn.confirm {
            background: var(--danger-color);
            color: white;
        }
        
        .warning-btn.confirm:hover {
            background: #c0392b;
        }
        
        /* Upcoming revisions */
        .upcoming-date-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .upcoming-date-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }
        
        .upcoming-date-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .upcoming-date-title {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .upcoming-date-count {
            background: var(--primary-color);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .upcoming-date-desc {
            font-size: 0.85rem;
            color: #666;
        }
        
        /* Revision Plan Settings Modal */
        .settings-modal {
            max-width: 800px;
        }
        
        .settings-tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .settings-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            color: #666;
        }
        
        .settings-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .settings-tab:hover {
            color: var(--primary-color);
        }
        
        .settings-content {
            display: none;
        }
        
        .settings-content.active {
            display: block;
        }
        
        .revision-plan-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
        }
        
        .plan-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .plan-select {
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            font-size: 1rem;
            min-width: 150px;
        }
        
        .intervals-container {
            margin-top: 20px;
        }
        
        .interval-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: var(--transition);
        }
        
        .interval-item:hover {
            background: #edf2f7;
        }
        
        .interval-number {
            font-weight: 700;
            color: var(--primary-color);
            min-width: 40px;
        }
        
        .interval-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .interval-input input {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            width: 100px;
            font-size: 1rem;
        }
        
        .interval-input label {
            font-weight: 600;
            color: #555;
        }
        
        .remove-interval {
            background: var(--danger-color);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            margin-left: auto;
        }
        
        .remove-interval:hover {
            background: #c0392b;
            transform: scale(1.1);
        }
        
        .add-interval-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            margin-top: 15px;
            transition: var(--transition);
        }
        
        .add-interval-btn:hover {
            background: #27ae60;
        }
        
        .plan-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: flex-end;
        }
        
        .current-plan-display {
            background: #f0f9f0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--success-color);
            margin-top: 20px;
        }
        
        .current-plan-title {
            font-weight: 700;
            color: var(--success-color);
            margin-bottom: 10px;
        }
        
        .current-plan-details {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .plan-detail {
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            animation: slideInRight 0.3s ease;
            max-width: 350px;
        }
        
        .notification.warning {
            background: #f39c12;
        }
        
        .notification.error {
            background: #e74c3c;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-section {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header-controls {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }
            
            .main-layout {
                gap: 20px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .neet-countdown {
                font-size: 0.9rem;
                padding: 8px 15px;
            }
            
            .subject-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .warning-actions {
                flex-direction: column;
            }
            
            .plan-controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .interval-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .remove-interval {
                margin-left: 0;
                align-self: flex-end;
            }
            
            .plan-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body class="theme-light-blue">
    <div class="container">
        <header>
            <h1><i class="fas fa-book-medical"></i> Revision Tracker | NEET 2026</h1>
            <div class="current-date" id="current-date">Loading date...</div>
            <div class="neet-countdown">
                <i class="fas fa-clock"></i> NEET 2026: <span id="neet-countdown" class="highlight">Calculating...</span> days left
            </div>
            
            <div class="header-controls">
                <div class="theme-selector">
                    <button class="control-btn" id="theme-toggle">
                        <i class="fas fa-palette"></i>
                    </button>
                    <div class="theme-dropdown" id="theme-dropdown">
                        <div class="theme-option theme-light-blue" data-theme="light-blue">
                            <div class="theme-color"></div>
                            <span>Light Blue</span>
                        </div>
                        <div class="theme-option theme-light-green" data-theme="light-green">
                            <div class="theme-color"></div>
                            <span>Light Green</span>
                        </div>
                        <div class="theme-option theme-light-pink" data-theme="light-pink">
                            <div class="theme-color"></div>
                            <span>Light Pink</span>
                        </div>
                        <div class="theme-option theme-light-purple" data-theme="light-purple">
                            <div class="theme-color"></div>
                            <span>Light Purple</span>
                        </div>
                        <div class="theme-option theme-light-orange" data-theme="light-orange">
                            <div class="theme-color"></div>
                            <span>Light Orange</span>
                        </div>
                        <div class="theme-option theme-black-white" data-theme="black-white">
                            <div class="theme-color"></div>
                            <span>Black & White</span>
                        </div>
                    </div>
                </div>
                
                <button class="control-btn" id="settings-toggle">
                    <i class="fas fa-cog"></i>
                </button>
                
                <button class="control-btn" id="fullscreen-toggle">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </header>
        
        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-label">Today's Revisions</div>
                <div class="stat-value" id="today-count">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Backlog Revisions</div>
                <div class="stat-value" id="backlog-count">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Chapters</div>
                <div class="stat-value" id="total-chapters">75</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Completed Chapters</div>
                <div class="stat-value" id="completed-chapters">0</div>
            </div>
        </div>
        
        <div class="main-layout">
            <div class="card">
                <h2><i class="fas fa-calendar-day"></i> Today's Revisions</h2>
                <div class="today-revision-list" id="today-revisions">
                    <div class="empty-state">
                        <i class="fas fa-check-circle"></i>
                        <p>No revisions scheduled for today!</p>
                        <p>Complete some chapters to schedule revisions.</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-tasks"></i> Backlog (Missed Revisions)</h2>
                <div class="backlog-list" id="backlog-revisions">
                    <div class="empty-state">
                        <i class="fas fa-clipboard-check"></i>
                        <p>No missed revisions! Great job keeping up!</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-calendar-alt"></i> Upcoming Revisions</h2>
                <div class="upcoming-revisions-list" id="upcoming-revisions">
                    <div class="empty-state">
                        <i class="fas fa-calendar"></i>
                        <p>No upcoming revisions!</p>
                        <p>Complete chapters to see upcoming revision dates.</p>
                    </div>
                </div>
                <button class="btn btn-primary" id="view-all-revisions" style="width: 100%; margin-top: 15px;">
                    <i class="fas fa-list"></i> View All Revision Dates
                </button>
            </div>
        </div>
        
        <div class="card">
            <h2><i class="fas fa-graduation-cap"></i> NCERT Chapters (NEET Syllabus)</h2>
            
            <div class="subject-tabs">
                <div class="subject-tab biology active" data-subject="all">All Subjects</div>
                <div class="subject-tab biology" data-subject="biology">Biology</div>
                <div class="subject-tab chemistry" data-subject="chemistry">Chemistry</div>
                <div class="subject-tab physics" data-subject="physics">Physics</div>
            </div>
            
            <div class="subject-stats">
                <div class="subject-stat biology">
                    <div class="subject-stat-value" id="biology-completed">0</div>
                    <div class="subject-stat-label">Biology Chapters (31)</div>
                </div>
                <div class="subject-stat chemistry">
                    <div class="subject-stat-value" id="chemistry-completed">0</div>
                    <div class="subject-stat-label">Chemistry Chapters (19)</div>
                </div>
                <div class="subject-stat physics">
                    <div class="subject-stat-value" id="physics-completed">0</div>
                    <div class="subject-stat-label">Physics Chapters (25)</div>
                </div>
            </div>
            
            <div class="chapters-grid" id="chapters-container">
                <!-- Chapters will be loaded here -->
            </div>
        </div>
        
        <div class="instructions">
            <h3><i class="fas fa-info-circle"></i> How to Use This Revision Tracker</h3>
            <div class="instructions-content">
                <div>
                    <h4><i class="fas fa-book"></i> Chapter Management</h4>
                    <ul>
                        <li>All NCERT chapters are pre-loaded for NEET preparation</li>
                        <li>Click "Mark as Completed" when you finish a chapter</li>
                        <li>Completed chapters will automatically schedule revisions based on your plan</li>
                        <li>Use the "Undo" button to mark a chapter incomplete if needed</li>
                        <li>Use the subject tabs to filter chapters</li>
                    </ul>
                </div>
                
                <div>
                    <h4><i class="fas fa-calendar-check"></i> Revision Schedule</h4>
                    <ul>
                        <li>Customize your revision plan using the settings (gear icon)</li>
                        <li>Set number of revisions and intervals between them</li>
                        <li>Check "Today's Revisions" daily for scheduled revisions</li>
                        <li>Mark revisions as completed or missed</li>
                        <li>Missed revisions appear in the "Backlog" section</li>
                        <li>View upcoming revisions in the "Upcoming Revisions" section</li>
                    </ul>
                </div>
                
                <div>
                    <h4><i class="fas fa-chart-line"></i> Progress Tracking</h4>
                    <ul>
                        <li>Track your progress with statistics at the top</li>
                        <li>Monitor subject-wise completion percentages</li>
                        <li>NEET countdown helps you stay on track</li>
                        <li>All data is saved automatically in your browser</li>
                    </ul>
                </div>
                
                <div>
                    <h4><i class="fas fa-cog"></i> App Features</h4>
                    <ul>
                        <li>Use the palette icon to change theme colors</li>
                        <li>Use the gear icon to customize revision plans</li>
                        <li>Use the expand icon for full-screen mode</li>
                        <li>Click on any date in "Upcoming Revisions" to see details</li>
                        <li>Use "View All Revision Dates" to see complete schedule</li>
                        <li>Responsive design works on all devices</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Revision Tracker for NEET 2026 &copy; 2023 | Customize your revision plan using settings</p>
            <p><small>Based on NCERT Class 11 & 12 syllabus for NEET preparation. Your data is stored locally in your browser.</small></p>
        </footer>
    </div>

    <!-- Modal for date-wise revision plan -->
    <div class="modal-overlay" id="revision-plan-modal">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-week"></i> Revision Plan</h3>
                <button class="close-modal" id="close-modal">&times;</button>
            </div>
            <div class="modal-content" id="modal-content">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Settings Modal for Revision Plan Customization -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal settings-modal">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Revision Plan Settings</h3>
                <button class="close-modal" id="close-settings-modal">&times;</button>
            </div>
            <div class="modal-content">
                <div class="settings-tabs">
                    <button class="settings-tab active" data-tab="customize">Customize Plan</button>
                    <button class="settings-tab" data-tab="current">Current Plan</button>
                </div>
                
                <div class="settings-content active" id="customize-tab">
                    <div class="revision-plan-info">
                        <p><strong>Customize your revision plan:</strong> Set how many times you want to revise each chapter and the intervals between revisions. Changes will apply to newly completed chapters.</p>
                    </div>
                    
                    <div class="plan-controls">
                        <div>
                            <label for="revision-count">Number of Revisions:</label>
                            <select id="revision-count" class="plan-select">
                                <option value="2">2 Revisions</option>
                                <option value="3">3 Revisions</option>
                                <option value="4">4 Revisions</option>
                                <option value="5" selected>5 Revisions</option>
                                <option value="6">6 Revisions</option>
                                <option value="7">7 Revisions</option>
                                <option value="8">8 Revisions</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="plan-preset">Quick Preset:</label>
                            <select id="plan-preset" class="plan-select">
                                <option value="custom">Custom Intervals</option>
                                <option value="default">Default (1, 4, 7, 14, 28 days)</option>
                                <option value="intensive">Intensive (1, 3, 7, 15, 30, 60 days)</option>
                                <option value="spaced">Spaced (1, 7, 30, 90 days)</option>
                                <option value="fast">Fast Track (1, 2, 4, 7 days)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="intervals-container">
                        <h4>Revision Intervals (in days after completion):</h4>
                        <div id="intervals-list">
                            <!-- Interval inputs will be added here -->
                        </div>
                        
                        <button class="add-interval-btn" id="add-interval">
                            <i class="fas fa-plus"></i> Add Another Revision
                        </button>
                    </div>
                    
                    <div class="plan-actions">
                        <button class="btn btn-secondary" id="reset-plan">
                            <i class="fas fa-undo"></i> Reset to Default
                        </button>
                        <button class="btn btn-primary" id="save-plan">
                            <i class="fas fa-save"></i> Save as My Plan
                        </button>
                    </div>
                </div>
                
                <div class="settings-content" id="current-tab">
                    <div class="revision-plan-info">
                        <p><strong>Your current revision plan:</strong> This plan is used to schedule revisions for newly completed chapters.</p>
                    </div>
                    
                    <div class="current-plan-display">
                        <div class="current-plan-title" id="current-plan-title">Current Plan</div>
                        <div class="current-plan-details" id="current-plan-details">
                            <!-- Current plan details will be shown here -->
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h4>How It Works:</h4>
                        <ul style="padding-left: 20px; margin-top: 10px;">
                            <li>When you mark a chapter as completed, revisions are scheduled based on your plan</li>
                            <li>Each revision is scheduled X days after the completion date</li>
                            <li>For example: If your plan is [1, 4, 7] days, you'll revise on day 1, 4, and 7 after completing the chapter</li>
                            <li>You can customize this for your learning style</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Warning dialog for undo chapter completion -->
    <div class="warning-dialog" id="undo-warning-dialog">
        <div class="warning-content">
            <div class="warning-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="warning-text" id="warning-text">
                Are you sure you want to mark this chapter as incomplete? This will remove all scheduled revisions for this chapter.
            </div>
            <div class="warning-actions">
                <button class="warning-btn cancel" id="cancel-undo">Cancel</button>
                <button class="warning-btn confirm" id="confirm-undo">Yes, Undo</button>
            </div>
        </div>
    </div>

    <script>
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            updateCurrentDate();
            
            // Initialize NEET countdown
            updateNEETCountdown();
            
            // Load data from localStorage
            loadData();
            
            // Set up event listeners for subject tabs
            document.querySelectorAll('.subject-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // Update active tab
                    document.querySelectorAll('.subject-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Filter chapters by subject
                    filterChaptersBySubject(this.dataset.subject);
                });
            });
            
            // Set up theme toggle
            document.getElementById('theme-toggle').addEventListener('click', function(e) {
                e.stopPropagation();
                const dropdown = document.getElementById('theme-dropdown');
                dropdown.classList.toggle('show');
            });
            
            // Set up theme selection
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.dataset.theme;
                    changeTheme(theme);
                    document.getElementById('theme-dropdown').classList.remove('show');
                });
            });
            
            // Set up settings toggle
            document.getElementById('settings-toggle').addEventListener('click', openSettingsModal);
            
            // Set up fullscreen toggle
            document.getElementById('fullscreen-toggle').addEventListener('click', toggleFullscreen);
            
            // Set up view all revisions button
            document.getElementById('view-all-revisions').addEventListener('click', showAllRevisionDates);
            
            // Set up modal close buttons
            document.getElementById('close-modal').addEventListener('click', closeRevisionPlanModal);
            document.getElementById('close-settings-modal').addEventListener('click', closeSettingsModal);
            
            // Set up warning dialog buttons
            document.getElementById('cancel-undo').addEventListener('click', cancelUndo);
            document.getElementById('confirm-undo').addEventListener('click', confirmUndo);
            
            // Set up settings tabs
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // Update active tab
                    document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show active content
                    document.querySelectorAll('.settings-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Set up revision plan controls
            document.getElementById('revision-count').addEventListener('change', updateIntervalInputs);
            document.getElementById('plan-preset').addEventListener('change', applyPlanPreset);
            document.getElementById('add-interval').addEventListener('click', addIntervalInput);
            document.getElementById('reset-plan').addEventListener('click', resetToDefaultPlan);
            document.getElementById('save-plan').addEventListener('click', saveCustomPlan);
            
            // Close modals when clicking outside
            document.getElementById('revision-plan-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeRevisionPlanModal();
                }
            });
            
            document.getElementById('settings-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSettingsModal();
                }
            });
            
            // Close warning dialog when clicking outside
            document.getElementById('undo-warning-dialog').addEventListener('click', function(e) {
                if (e.target === this) {
                    cancelUndo();
                }
            });
            
            // Initialize the interval inputs
            initializeIntervalInputs();
            
            // Update the display
            updateDisplay();
            
            // Update NEET countdown every minute
            setInterval(updateNEETCountdown, 60000);
            
            // Load saved theme on page load
            const savedTheme = localStorage.getItem('revisionTrackerTheme') || 'light-blue';
            changeTheme(savedTheme);
        });
        
        // Data structure to store chapters and revisions
        let revisionData = {
            chapters: [],
            revisions: [],
            missedRevisions: []
        };
        
        // Default revision plan (1, 4, 7, 14, 28 days)
        const DEFAULT_REVISION_PLAN = [1, 4, 7, 14, 28];
        
        // Current revision plan (can be customized)
        let currentRevisionPlan = [...DEFAULT_REVISION_PLAN];
        
        // Variable to store chapter ID for undo operation
        let chapterToUndo = null;
        
        // Predefined NCERT chapters in proper sequence
        const ncertChapters = [
            // Biology Class 11 (in order)
            { id: 101, name: "The Living World", subject: "biology", class: "11", order: 1 },
            { id: 102, name: "Biological Classification", subject: "biology", class: "11", order: 2 },
            { id: 103, name: "Plant Kingdom", subject: "biology", class: "11", order: 3 },
            { id: 104, name: "Animal Kingdom", subject: "biology", class: "11", order: 4 },
            { id: 105, name: "Morphology of Flowering Plants", subject: "biology", class: "11", order: 5 },
            { id: 106, name: "Anatomy of Flowering Plants", subject: "biology", class: "11", order: 6 },
            { id: 107, name: "Structural Organization in Animals", subject: "biology", class: "11", order: 7 },
            { id: 108, name: "Cell: The Unit of Life", subject: "biology", class: "11", order: 8 },
            { id: 109, name: "Biomolecules", subject: "biology", class: "11", order: 9 },
            { id: 110, name: "Cell Cycle and Cell Division", subject: "biology", class: "11", order: 10 },
            { id: 111, name: "Photosynthesis in Higher Plants", subject: "biology", class: "11", order: 11 },
            { id: 112, name: "Respiration in Plants", subject: "biology", class: "11", order: 12 },
            { id: 113, name: "Plant Growth and Development", subject: "biology", class: "11", order: 13 },
            { id: 114, name: "Breathing and Exchange of Gases", subject: "biology", class: "11", order: 14 },
            { id: 115, name: "Body Fluids and Circulation", subject: "biology", class: "11", order: 15 },
            { id: 116, name: "Excretory Products and Their Elimination", subject: "biology", class: "11", order: 16 },
            { id: 117, name: "Locomotion and Movement", subject: "biology", class: "11", order: 17 },
            { id: 118, name: "Neural Control and Coordination", subject: "biology", class: "11", order: 18 },
            { id: 119, name: "Chemical Coordination and Integration", subject: "biology", class: "11", order: 19 },
            
            // Biology Class 12 (in order)
            { id: 120, name: "Sexual Reproduction in Flowering Plants", subject: "biology", class: "12", order: 1 },
            { id: 121, name: "Human Reproduction", subject: "biology", class: "12", order: 2 },
            { id: 122, name: "Reproductive Health", subject: "biology", class: "12", order: 3 },
            { id: 123, name: "Principles of Inheritance and Variation", subject: "biology", class: "12", order: 4 },
            { id: 124, name: "Molecular Basis of Inheritance", subject: "biology", class: "12", order: 5 },
            { id: 125, name: "Evolution", subject: "biology", class: "12", order: 6 },
            { id: 126, name: "Human Health and Disease", subject: "biology", class: "12", order: 7 },
            { id: 127, name: "Microbes in Human Welfare", subject: "biology", class: "12", order: 8 },
            { id: 128, name: "Biotechnology: Principles and Processes", subject: "biology", class: "12", order: 9 },
            { id: 129, name: "Biotechnology and its Applications", subject: "biology", class: "12", order: 10 },
            { id: 130, name: "Organisms and Populations", subject: "biology", class: "12", order: 11 },
            { id: 131, name: "Ecosystem", subject: "biology", class: "12", order: 12 },
            { id: 132, name: "Biodiversity and Conservation", subject: "biology", class: "12", order: 13 },
            
            // Chemistry Class 11 (in order)
            { id: 201, name: "Some Basic Concepts of Chemistry", subject: "chemistry", class: "11", order: 1 },
            { id: 202, name: "Structure of Atom", subject: "chemistry", class: "11", order: 2 },
            { id: 203, name: "Classification of Elements and Periodicity in Properties", subject: "chemistry", class: "11", order: 3 },
            { id: 204, name: "Chemical Bonding and Molecular Structure", subject: "chemistry", class: "11", order: 4 },
            { id: 205, name: "States of Matter: Gases and Liquids", subject: "chemistry", class: "11", order: 5 },
            { id: 206, name: "Thermodynamics", subject: "chemistry", class: "11", order: 6 },
            { id: 207, name: "Equilibrium", subject: "chemistry", class: "11", order: 7 },
            { id: 208, name: "Redox Reactions", subject: "chemistry", class: "11", order: 8 },
            { id: 209, name: "Hydrogen", subject: "chemistry", class: "11", order: 9 },
            { id: 210, name: "The s-Block Elements", subject: "chemistry", class: "11", order: 10 },
            { id: 211, name: "The p-Block Elements (Group 13 & 14)", subject: "chemistry", class: "11", order: 11 },
            { id: 212, name: "Organic Chemistry: Some Basic Principles and Techniques", subject: "chemistry", class: "11", order: 12 },
            { id: 213, name: "Hydrocarbons", subject: "chemistry", class: "11", order: 13 },
            { id: 214, name: "Environmental Chemistry", subject: "chemistry", class: "11", order: 14 },
            
            // Chemistry Class 12 (in order)
            { id: 215, name: "The Solid State", subject: "chemistry", class: "12", order: 1 },
            { id: 216, name: "Solutions", subject: "chemistry", class: "12", order: 2 },
            { id: 217, name: "Electrochemistry", subject: "chemistry", class: "12", order: 3 },
            { id: 218, name: "Chemical Kinetics", subject: "chemistry", class: "12", order: 4 },
            { id: 219, name: "Surface Chemistry", subject: "chemistry", class: "12", order: 5 },
            { id: 220, name: "General Principles and Processes of Isolation of Elements", subject: "chemistry", class: "12", order: 6 },
            { id: 221, name: "The p-Block Elements (Group 15-18)", subject: "chemistry", class: "12", order: 7 },
            { id: 222, name: "The d- and f-Block Elements", subject: "chemistry", class: "12", order: 8 },
            { id: 223, name: "Coordination Compounds", subject: "chemistry", class: "12", order: 9 },
            { id: 224, name: "Haloalkanes and Haloarenes", subject: "chemistry", class: "12", order: 10 },
            { id: 225, name: "Alcohols, Phenols and Ethers", subject: "chemistry", class: "12", order: 11 },
            { id: 226, name: "Aldehydes, Ketones and Carboxylic Acids", subject: "chemistry", class: "12", order: 12 },
            { id: 227, name: "Amines", subject: "chemistry", class: "12", order: 13 },
            { id: 228, name: "Biomolecules", subject: "chemistry", class: "12", order: 14 },
            { id: 229, name: "Polymers", subject: "chemistry", class: "12", order: 15 },
            { id: 230, name: "Chemistry in Everyday Life", subject: "chemistry", class: "12", order: 16 },
            
            // Physics Class 11 (in order)
            { id: 301, name: "Units and Measurements", subject: "physics", class: "11", order: 1 },
            { id: 302, name: "Motion in a Straight Line", subject: "physics", class: "11", order: 2 },
            { id: 303, name: "Motion in a Plane", subject: "physics", class: "11", order: 3 },
            { id: 304, name: "Laws of Motion", subject: "physics", class: "11", order: 4 },
            { id: 305, name: "Work, Energy and Power", subject: "physics", class: "11", order: 5 },
            { id: 306, name: "System of Particles and Rotational Motion", subject: "physics", class: "11", order: 6 },
            { id: 307, name: "Gravitation", subject: "physics", class: "11", order: 7 },
            { id: 308, name: "Mechanical Properties of Solids", subject: "physics", class: "11", order: 8 },
            { id: 309, name: "Mechanical Properties of Fluids", subject: "physics", class: "11", order: 9 },
            { id: 310, name: "Thermal Properties of Matter", subject: "physics", class: "11", order: 10 },
            { id: 311, name: "Thermodynamics", subject: "physics", class: "11", order: 11 },
            { id: 312, name: "Kinetic Theory", subject: "physics", class: "11", order: 12 },
            { id: 313, name: "Oscillations", subject: "physics", class: "11", order: 13 },
            { id: 314, name: "Waves", subject: "physics", class: "11", order: 14 },
            
            // Physics Class 12 (in order)
            { id: 315, name: "Electric Charges and Fields", subject: "physics", class: "12", order: 1 },
            { id: 316, name: "Electrostatic Potential and Capacitance", subject: "physics", class: "12", order: 2 },
            { id: 317, name: "Current Electricity", subject: "physics", class: "12", order: 3 },
            { id: 318, name: "Moving Charges and Magnetism", subject: "physics", class: "12", order: 4 },
            { id: 319, name: "Magnetism and Matter", subject: "physics", class: "12", order: 5 },
            { id: 320, name: "Electromagnetic Induction", subject: "physics", class: "12", order: 6 },
            { id: 321, name: "Alternating Current", subject: "physics", class: "12", order: 7 },
            { id: 322, name: "Electromagnetic Waves", subject: "physics", class: "12", order: 8 },
            { id: 323, name: "Ray Optics and Optical Instruments", subject: "physics", class: "12", order: 9 },
            { id: 324, name: "Wave Optics", subject: "physics", class: "12", order: 10 },
            { id: 325, name: "Dual Nature of Radiation and Matter", subject: "physics", class: "12", order: 11 },
            { id: 326, name: "Atoms", subject: "physics", class: "12", order: 12 },
            { id: 327, name: "Nuclei", subject: "physics", class: "12", order: 13 },
            { id: 328, name: "Semiconductor Electronics: Materials, Devices and Simple Circuits", subject: "physics", class: "12", order: 14 },
            { id: 329, name: "Communication Systems", subject: "physics", class: "12", order: 15 }
        ];
        
        // Update current date display
        function updateCurrentDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateString = now.toLocaleDateString('en-US', options);
            document.getElementById('current-date').textContent = dateString;
        }
        
        // Update NEET countdown
        function updateNEETCountdown() {
            const neetDate = new Date('May 3, 2026 00:00:00');
            const today = new Date();
            
            // Calculate difference in days
            const diffTime = neetDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // Update display
            const countdownElement = document.getElementById('neet-countdown');
            if (diffDays > 0) {
                countdownElement.textContent = diffDays;
                countdownElement.style.color = diffDays < 100 ? '#ff6b6b' : '#ffeb3b';
            } else if (diffDays === 0) {
                countdownElement.textContent = "Today is NEET!";
                countdownElement.style.color = '#ff0000';
            } else {
                countdownElement.textContent = "NEET has passed";
                countdownElement.style.color = '#999';
            }
        }
        
        // Format date as YYYY-MM-DD for easier comparison
        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }
        
        // Format date for display (e.g., Jan 10, 2023)
        function formatDateDisplay(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }
        
        // Get today's date in formatted string
        function getToday() {
            return formatDate(new Date());
        }
        
        // Load data from localStorage
        function loadData() {
            const savedData = localStorage.getItem('ncertRevisionTrackerData');
            
            if (savedData) {
                revisionData = JSON.parse(savedData);
            } else {
                // Initialize with all NCERT chapters as active (not completed)
                revisionData.chapters = ncertChapters.map(chapter => ({
                    ...chapter,
                    addedDate: getToday(),
                    isCompleted: false,
                    completedDate: null
                }));
                
                // Initialize with some sample completed chapters for demo
                // You can remove this in production
                initializeSampleData();
            }
            
            // Load custom revision plan if available
            const savedPlan = localStorage.getItem('customRevisionPlan');
            if (savedPlan) {
                currentRevisionPlan = JSON.parse(savedPlan);
            }
            
            // Check for missed revisions based on past dates
            checkForMissedRevisions();
        }
        
        // Initialize with some sample data for demo
        function initializeSampleData() {
            // Mark first 5 chapters as completed for demo
            const sampleChapters = [101, 102, 201, 202, 301];
            
            sampleChapters.forEach(chapterId => {
                const chapterIndex = revisionData.chapters.findIndex(ch => ch.id === chapterId);
                if (chapterIndex !== -1) {
                    revisionData.chapters[chapterIndex].isCompleted = true;
                    revisionData.chapters[chapterIndex].completedDate = getToday();
                    
                    // Schedule revisions
                    scheduleRevisionsForChapter(revisionData.chapters[chapterIndex]);
                }
            });
            
            saveData();
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('ncertRevisionTrackerData', JSON.stringify(revisionData));
        }
        
        // Save custom revision plan
        function saveCustomPlan() {
            // Get intervals from inputs
            const intervalInputs = document.querySelectorAll('.interval-input input');
            const intervals = [];
            
            intervalInputs.forEach(input => {
                const value = parseInt(input.value);
                if (!isNaN(value) && value > 0) {
                    intervals.push(value);
                }
            });
            
            // Sort intervals
            intervals.sort((a, b) => a - b);
            
            // Validate intervals
            if (intervals.length === 0) {
                showNotification('Please add at least one revision interval', 'error');
                return;
            }
            
            if (intervals.some(interval => interval <= 0)) {
                showNotification('All intervals must be positive numbers', 'error');
                return;
            }
            
            // Check for duplicates
            const uniqueIntervals = [...new Set(intervals)];
            if (uniqueIntervals.length !== intervals.length) {
                showNotification('Intervals should be unique', 'error');
                return;
            }
            
            // Save the plan
            currentRevisionPlan = intervals;
            localStorage.setItem('customRevisionPlan', JSON.stringify(currentRevisionPlan));
            
            // Update display
            updateCurrentPlanDisplay();
            
            // Show notification
            showNotification(`Custom revision plan saved! (${intervals.length} revisions)`, 'success');
            
            // Switch to current plan tab
            document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.settings-tab[data-tab="current"]').classList.add('active');
            document.querySelectorAll('.settings-content').forEach(content => content.classList.remove('active'));
            document.getElementById('current-tab').classList.add('active');
        }
        
        // Mark a chapter as completed
        function markChapterAsCompleted(chapterId) {
            const chapterIndex = revisionData.chapters.findIndex(ch => ch.id === chapterId);
            
            if (chapterIndex !== -1) {
                const chapter = revisionData.chapters[chapterIndex];
                
                if (chapter.isCompleted) {
                    // If already completed, ask if user wants to reschedule revisions
                    if (confirm('This chapter is already marked as completed. Do you want to reschedule revisions from today?')) {
                        // Remove existing revisions for this chapter
                        revisionData.revisions = revisionData.revisions.filter(rev => rev.chapterId !== chapterId);
                        
                        // Schedule new revisions
                        scheduleRevisionsForChapter(chapter);
                        
                        // Update completed date
                        chapter.completedDate = getToday();
                        
                        saveData();
                        updateDisplay();
                        
                        showNotification(`Revisions for "${chapter.name}" rescheduled from today!`, 'success');
                    }
                    return;
                }
                
                // Mark chapter as completed
                chapter.isCompleted = true;
                chapter.completedDate = getToday();
                
                // Schedule revisions
                scheduleRevisionsForChapter(chapter);
                
                saveData();
                updateDisplay();
                
                showNotification(`Chapter "${chapter.name}" marked as completed! ${currentRevisionPlan.length} revisions scheduled.`, 'success');
            }
        }
        
        // Schedule revisions for a chapter using current plan
        function scheduleRevisionsForChapter(chapter) {
            const today = new Date();
            
            currentRevisionPlan.forEach((interval, index) => {
                const revisionDate = new Date(today);
                revisionDate.setDate(revisionDate.getDate() + interval);
                
                const revision = {
                    id: Date.now() + Math.random(),
                    chapterId: chapter.id,
                    chapterName: chapter.name,
                    chapterSubject: chapter.subject,
                    revisionNumber: index + 1,
                    scheduledDate: formatDate(revisionDate),
                    isCompleted: false,
                    completedDate: null,
                    isMissed: false
                };
                
                revisionData.revisions.push(revision);
            });
        }
        
        // Mark a revision as completed
        function markRevisionAsCompleted(revisionId) {
            const revisionIndex = revisionData.revisions.findIndex(rev => rev.id === revisionId);
            
            if (revisionIndex !== -1) {
                revisionData.revisions[revisionIndex].isCompleted = true;
                revisionData.revisions[revisionIndex].completedDate = getToday();
                
                // Remove from missed revisions if it's there
                const missedIndex = revisionData.missedRevisions.findIndex(rev => rev.revisionId === revisionId);
                if (missedIndex !== -1) {
                    revisionData.missedRevisions.splice(missedIndex, 1);
                }
                
                saveData();
                updateDisplay();
                
                // Show success message
                const chapterName = revisionData.revisions[revisionIndex].chapterName;
                const revisionNum = revisionData.revisions[revisionIndex].revisionNumber;
                showNotification(`Revision R${revisionNum} of "${chapterName}" marked as completed!`, 'success');
            }
        }
        
        // Mark a revision as missed
        function markRevisionAsMissed(revisionId) {
            const revisionIndex = revisionData.revisions.findIndex(rev => rev.id === revisionId);
            
            if (revisionIndex !== -1) {
                const revision = revisionData.revisions[revisionIndex];
                revision.isMissed = true;
                
                // Add to missed revisions with today's date
                const missedRevision = {
                    revisionId: revision.id,
                    chapterId: revision.chapterId,
                    chapterName: revision.chapterName,
                    chapterSubject: revision.chapterSubject,
                    revisionNumber: revision.revisionNumber,
                    missedDate: getToday(),
                    lastRevisionDate: revision.completedDate || "Never revised"
                };
                
                // Check if already in missed revisions
                const existingIndex = revisionData.missedRevisions.findIndex(rev => rev.revisionId === revisionId);
                if (existingIndex === -1) {
                    revisionData.missedRevisions.push(missedRevision);
                }
                
                saveData();
                updateDisplay();
                
                // Show notification
                showNotification(`Revision R${revision.revisionNumber} of "${revision.chapterName}" marked as missed. Added to backlog.`, 'warning');
            }
        }
        
        // Show warning dialog for undoing chapter completion
        function showUndoWarning(chapterId) {
            const chapter = revisionData.chapters.find(ch => ch.id === chapterId);
            if (!chapter) return;
            
            document.getElementById('warning-text').textContent = 
                `Are you sure you want to mark "${chapter.name}" as incomplete? This will remove all scheduled revisions for this chapter.`;
            
            chapterToUndo = chapterId;
            document.getElementById('undo-warning-dialog').classList.add('active');
        }
        
        // Cancel undo operation
        function cancelUndo() {
            chapterToUndo = null;
            document.getElementById('undo-warning-dialog').classList.remove('active');
        }
        
        // Confirm undo operation
        function confirmUndo() {
            if (chapterToUndo) {
                undoChapterCompletion(chapterToUndo);
                chapterToUndo = null;
            }
            document.getElementById('undo-warning-dialog').classList.remove('active');
        }
        
        // Undo chapter completion
        function undoChapterCompletion(chapterId) {
            const chapterIndex = revisionData.chapters.findIndex(ch => ch.id === chapterId);
            
            if (chapterIndex !== -1) {
                const chapter = revisionData.chapters[chapterIndex];
                
                // Mark chapter as incomplete
                chapter.isCompleted = false;
                chapter.completedDate = null;
                
                // Remove all revisions for this chapter
                revisionData.revisions = revisionData.revisions.filter(rev => rev.chapterId !== chapterId);
                
                // Remove from missed revisions
                revisionData.missedRevisions = revisionData.missedRevisions.filter(rev => rev.chapterId !== chapterId);
                
                saveData();
                updateDisplay();
                
                showNotification(`Chapter "${chapter.name}" marked as incomplete. All revisions removed.`, 'success');
            }
        }
        
        // Update all displays
        function updateDisplay() {
            updateTodayRevisions();
            updateBacklogRevisions();
            updateUpcomingRevisions();
            updateChaptersList();
            updateStats();
        }
        
        // Update today's revisions display
        function updateTodayRevisions() {
            const today = getToday();
            const todayContainer = document.getElementById('today-revisions');
            
            // Filter revisions scheduled for today that are not completed
            const todayRevisions = revisionData.revisions.filter(rev => 
                rev.scheduledDate === today && !rev.isCompleted
            );
            
            if (todayRevisions.length === 0) {
                todayContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-check-circle"></i>
                        <p>No revisions scheduled for today!</p>
                        <p>Complete some chapters to schedule revisions.</p>
                    </div>
                `;
                return;
            }
            
            // Sort by subject and chapter name
            todayRevisions.sort((a, b) => {
                if (a.chapterSubject !== b.chapterSubject) {
                    return a.chapterSubject.localeCompare(b.chapterSubject);
                }
                return a.chapterName.localeCompare(b.chapterName);
            });
            
            // Generate HTML for each revision
            let html = '';
            todayRevisions.forEach(rev => {
                // Find the chapter to get added date
                const chapter = revisionData.chapters.find(ch => ch.id === rev.chapterId);
                const addedDate = chapter ? chapter.addedDate : 'Unknown';
                
                html += `
                    <div class="revision-item">
                        <div class="chapter-info">
                            <div class="chapter-name">${rev.chapterName}</div>
                            <div class="chapter-meta">
                                <span><i class="fas fa-book"></i> ${rev.chapterSubject.charAt(0).toUpperCase() + rev.chapterSubject.slice(1)}</span>
                                <span><i class="fas fa-redo"></i> Revision: R${rev.revisionNumber}/${currentRevisionPlan.length}</span>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="action-btn complete-revision-btn" onclick="markRevisionAsCompleted(${rev.id})">
                                <i class="fas fa-check"></i> Done
                            </button>
                            <button class="action-btn missed-revision-btn" onclick="markRevisionAsMissed(${rev.id})">
                                <i class="fas fa-times"></i> Miss
                            </button>
                        </div>
                    </div>
                `;
            });
            
            todayContainer.innerHTML = html;
        }
        
        // Update backlog revisions display
        function updateBacklogRevisions() {
            const backlogContainer = document.getElementById('backlog-revisions');
            
            if (revisionData.missedRevisions.length === 0) {
                backlogContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-check"></i>
                        <p>No missed revisions! Great job keeping up!</p>
                    </div>
                `;
                return;
            }
            
            // Sort by missed date (most recent first)
            const sortedMissed = [...revisionData.missedRevisions].sort((a, b) => 
                new Date(b.missedDate) - new Date(a.missedDate)
            );
            
            // Generate HTML for each missed revision
            let html = '';
            sortedMissed.forEach(missed => {
                // Find the original revision to get scheduled date
                const revision = revisionData.revisions.find(rev => rev.id === missed.revisionId);
                const scheduledDate = revision ? revision.scheduledDate : 'Unknown';
                
                html += `
                    <div class="revision-item missed">
                        <div class="chapter-info">
                            <div class="chapter-name">${missed.chapterName}</div>
                            <div class="chapter-meta">
                                <span><i class="fas fa-book"></i> ${missed.chapterSubject.charAt(0).toUpperCase() + missed.chapterSubject.slice(1)}</span>
                                <span><i class="fas fa-exclamation-circle"></i> Missed: ${missed.missedDate}</span>
                                <span><i class="fas fa-redo"></i> Revision: R${missed.revisionNumber} missed</span>
                            </div>
                        </div>
                        <div class="revision-badge missed">R${missed.revisionNumber} Missed</div>
                    </div>
                `;
            });
            
            backlogContainer.innerHTML = html;
        }
        
        // Update upcoming revisions display
        function updateUpcomingRevisions() {
            const upcomingContainer = document.getElementById('upcoming-revisions');
            const today = getToday();
            
            // Get all future revisions (not completed, not missed, and after today)
            const upcomingRevisions = revisionData.revisions.filter(rev => 
                rev.scheduledDate > today && !rev.isCompleted && !rev.isMissed
            );
            
            if (upcomingRevisions.length === 0) {
                upcomingContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar"></i>
                        <p>No upcoming revisions!</p>
                        <p>Complete chapters to see upcoming revision dates.</p>
                    </div>
                `;
                return;
            }
            
            // Group revisions by date
            const revisionsByDate = {};
            upcomingRevisions.forEach(rev => {
                if (!revisionsByDate[rev.scheduledDate]) {
                    revisionsByDate[rev.scheduledDate] = [];
                }
                revisionsByDate[rev.scheduledDate].push(rev);
            });
            
            // Get dates and sort them
            const dates = Object.keys(revisionsByDate).sort();
            
            // Only show next 5 dates
            const nextDates = dates.slice(0, 5);
            
            if (nextDates.length === 0) {
                upcomingContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar"></i>
                        <p>No upcoming revisions!</p>
                        <p>Complete chapters to see upcoming revision dates.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            nextDates.forEach(date => {
                const revisions = revisionsByDate[date];
                const revisionCount = revisions.length;
                
                // Get subject breakdown
                const subjects = {};
                revisions.forEach(rev => {
                    if (!subjects[rev.chapterSubject]) {
                        subjects[rev.chapterSubject] = 0;
                    }
                    subjects[rev.chapterSubject]++;
                });
                
                const subjectText = Object.keys(subjects).map(sub => {
                    return `${subjects[sub]} ${sub}`;
                }).join(', ');
                
                html += `
                    <div class="upcoming-date-item" onclick="showDateRevisions('${date}')">
                        <div class="upcoming-date-header">
                            <div class="upcoming-date-title">${formatDateDisplay(date)}</div>
                            <div class="upcoming-date-count">${revisionCount} revision${revisionCount > 1 ? 's' : ''}</div>
                        </div>
                        <div class="upcoming-date-desc">${subjectText}</div>
                    </div>
                `;
            });
            
            upcomingContainer.innerHTML = html;
        }
        
        // Update chapters list display
        function updateChaptersList() {
            // Filter chapters by active subject tab
            const activeSubject = document.querySelector('.subject-tab.active').dataset.subject;
            filterChaptersBySubject(activeSubject);
        }
        
        // Filter chapters by subject
        function filterChaptersBySubject(subject) {
            const chaptersContainer = document.getElementById('chapters-container');
            
            let filteredChapters = revisionData.chapters;
            
            if (subject !== 'all') {
                filteredChapters = revisionData.chapters.filter(ch => ch.subject === subject);
            }
            
            // Sort chapters by class and then by order
            const sortedChapters = [...filteredChapters].sort((a, b) => {
                // First sort by class
                if (a.class !== b.class) {
                    return a.class.localeCompare(b.class);
                }
                // Then sort by order
                return a.order - b.order;
            });
            
            if (sortedChapters.length === 0) {
                chaptersContainer.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-book"></i>
                        <p>No chapters found for this subject.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            sortedChapters.forEach(chapter => {
                // Count revisions for this chapter
                const chapterRevisions = revisionData.revisions.filter(rev => rev.chapterId === chapter.id);
                const completedRevisions = chapterRevisions.filter(rev => rev.isCompleted).length;
                const totalRevisions = chapterRevisions.length;
                
                // Find next revision date
                const nextRevision = chapterRevisions
                    .filter(rev => !rev.isCompleted && !rev.isMissed)
                    .sort((a, b) => new Date(a.scheduledDate) - new Date(b.scheduledDate))[0];
                
                const nextRevDate = nextRevision ? formatDateDisplay(nextRevision.scheduledDate) : 'None scheduled';
                
                html += `
                    <div class="chapter-item ${chapter.isCompleted ? 'completed' : ''}">
                        <div class="chapter-info">
                            <div class="chapter-name">${chapter.name}</div>
                            <div class="chapter-meta">
                                <span class="chapter-subject" style="background: ${getSubjectColor(chapter.subject)}">${chapter.subject.charAt(0).toUpperCase() + chapter.subject.slice(1)} - Class ${chapter.class}</span>
                                ${chapter.isCompleted && totalRevisions > 0 ? `<span><i class="fas fa-redo"></i> ${completedRevisions}/${totalRevisions} done</span>` : ''}
                            </div>
                            ${chapter.isCompleted && nextRevision ? `<div class="revision-date"><i class="far fa-calendar"></i> Next revision: ${nextRevDate}</div>` : ''}
                        </div>
                        <div class="chapter-actions">
                            ${chapter.isCompleted ? 
                                `<button class="complete-btn"><i class="fas fa-check"></i> Completed</button>
                                 <button class="undo-btn" onclick="showUndoWarning(${chapter.id})"><i class="fas fa-undo"></i> Undo</button>` :
                                `<button class="complete-btn" onclick="markChapterAsCompleted(${chapter.id})"><i class="fas fa-check"></i> Mark as Completed</button>`
                            }
                        </div>
                    </div>
                `;
            });
            
            chaptersContainer.innerHTML = html;
        }
        
        // Get color for subject
        function getSubjectColor(subject) {
            switch(subject) {
                case 'biology': return '#2ecc71';
                case 'chemistry': return '#e74c3c';
                case 'physics': return '#3498db';
                default: return '#95a5a6';
            }
        }
        
        // Update statistics
        function updateStats() {
            const today = getToday();
            
            // Today's revisions count
            const todayRevisions = revisionData.revisions.filter(rev => 
                rev.scheduledDate === today && !rev.isCompleted
            ).length;
            
            // Backlog count
            const backlogCount = revisionData.missedRevisions.length;
            
            // Total chapters count
            const totalChapters = revisionData.chapters.length;
            
            // Completed chapters count
            const completedChapters = revisionData.chapters.filter(ch => ch.isCompleted).length;
            
            // Subject-wise completed counts
            const biologyCompleted = revisionData.chapters.filter(ch => ch.subject === 'biology' && ch.isCompleted).length;
            const chemistryCompleted = revisionData.chapters.filter(ch => ch.subject === 'chemistry' && ch.isCompleted).length;
            const physicsCompleted = revisionData.chapters.filter(ch => ch.subject === 'physics' && ch.isCompleted).length;
            
            // Update DOM
            document.getElementById('today-count').textContent = todayRevisions;
            document.getElementById('backlog-count').textContent = backlogCount;
            document.getElementById('total-chapters').textContent = totalChapters;
            document.getElementById('completed-chapters').textContent = completedChapters;
            
            // Update subject stats
            document.getElementById('biology-completed').textContent = `${biologyCompleted}/31`;
            document.getElementById('chemistry-completed').textContent = `${chemistryCompleted}/19`;
            document.getElementById('physics-completed').textContent = `${physicsCompleted}/25`;
        }
        
        // Check for revisions that were scheduled in the past but not completed
        function checkForMissedRevisions() {
            const today = getToday();
            let missedFound = false;
            
            revisionData.revisions.forEach(rev => {
                // If revision was scheduled before today and not completed/missed
                if (rev.scheduledDate < today && !rev.isCompleted && !rev.isMissed) {
                    rev.isMissed = true;
                    missedFound = true;
                    
                    // Add to missed revisions if not already there
                    const existingIndex = revisionData.missedRevisions.findIndex(mr => mr.revisionId === rev.id);
                    if (existingIndex === -1) {
                        const missedRevision = {
                            revisionId: rev.id,
                            chapterId: rev.chapterId,
                            chapterName: rev.chapterName,
                            chapterSubject: rev.chapterSubject,
                            revisionNumber: rev.revisionNumber,
                            missedDate: rev.scheduledDate,
                            lastRevisionDate: rev.completedDate || "Never revised"
                        };
                        
                        revisionData.missedRevisions.push(missedRevision);
                    }
                }
            });
            
            if (missedFound) {
                saveData();
            }
        }
        
        // Change theme
        function changeTheme(theme) {
            // Remove all theme classes
            document.body.classList.remove('theme-light-blue', 'theme-light-green', 'theme-light-pink', 'theme-light-purple', 'theme-light-orange', 'theme-black-white');
            
            // Add selected theme class
            document.body.classList.add(`theme-${theme}`);
            
            // Save theme preference
            localStorage.setItem('revisionTrackerTheme', theme);
            
            // Update UI elements to match theme
            updateThemeUI(theme);
        }
        
        // Update UI elements to match theme
        function updateThemeUI(theme) {
            // This function can be extended to update other UI elements
            showNotification(`Theme changed to ${theme.replace('-', ' ')}`, 'success');
        }
        
        // Toggle fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
                document.getElementById('fullscreen-toggle').innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    document.getElementById('fullscreen-toggle').innerHTML = '<i class="fas fa-expand"></i>';
                }
            }
        }
        
        // Open settings modal
        function openSettingsModal() {
            // Update interval inputs to match current plan
            initializeIntervalInputs();
            
            // Update current plan display
            updateCurrentPlanDisplay();
            
            // Show modal
            document.getElementById('settings-modal').classList.add('active');
        }
        
        // Close settings modal
        function closeSettingsModal() {
            document.getElementById('settings-modal').classList.remove('active');
        }
        
        // Close revision plan modal
        function closeRevisionPlanModal() {
            document.getElementById('revision-plan-modal').classList.remove('active');
        }
        
        // Initialize interval inputs based on current plan
        function initializeIntervalInputs() {
            const intervalsList = document.getElementById('intervals-list');
            intervalsList.innerHTML = '';
            
            // Set revision count dropdown
            document.getElementById('revision-count').value = currentRevisionPlan.length;
            
            // Create inputs for each interval
            currentRevisionPlan.forEach((interval, index) => {
                addIntervalInputElement(interval, index);
            });
        }
        
        // Add interval input element
        function addIntervalInputElement(value, index) {
            const intervalsList = document.getElementById('intervals-list');
            
            const intervalItem = document.createElement('div');
            intervalItem.className = 'interval-item';
            intervalItem.innerHTML = `
                <div class="interval-number">R${index + 1}</div>
                <div class="interval-input">
                    <input type="number" min="1" max="365" value="${value}" placeholder="Days">
                    <label>day(s) after completion</label>
                </div>
                ${index > 0 ? `<button class="remove-interval" onclick="removeIntervalInput(this)"><i class="fas fa-times"></i></button>` : ''}
            `;
            
            intervalsList.appendChild(intervalItem);
        }
        
        // Update interval inputs when revision count changes
        function updateIntervalInputs() {
            const count = parseInt(document.getElementById('revision-count').value);
            const currentCount = document.querySelectorAll('.interval-item').length;
            
            if (count > currentCount) {
                // Add more intervals
                for (let i = currentCount; i < count; i++) {
                    // Default to previous interval + 7 days, or 7 if first
                    let defaultValue = 7;
                    if (i > 0) {
                        const lastInput = document.querySelectorAll('.interval-input input')[i-1];
                        if (lastInput) {
                            defaultValue = parseInt(lastInput.value) + 7;
                        }
                    }
                    addIntervalInputElement(defaultValue, i);
                }
            } else if (count < currentCount) {
                // Remove intervals
                const intervalsList = document.getElementById('intervals-list');
                const items = document.querySelectorAll('.interval-item');
                
                for (let i = currentCount - 1; i >= count; i--) {
                    intervalsList.removeChild(items[i]);
                }
            }
        }
        
        // Add interval input
        function addIntervalInput() {
            const intervalsList = document.getElementById('intervals-list');
            const currentCount = document.querySelectorAll('.interval-item').length;
            
            // Default to previous interval + 7 days, or 7 if first
            let defaultValue = 7;
            if (currentCount > 0) {
                const lastInput = document.querySelectorAll('.interval-input input')[currentCount-1];
                if (lastInput) {
                    defaultValue = parseInt(lastInput.value) + 7;
                }
            }
            
            addIntervalInputElement(defaultValue, currentCount);
            
            // Update revision count dropdown
            document.getElementById('revision-count').value = currentCount + 1;
        }
        
        // Remove interval input
        function removeIntervalInput(button) {
            const intervalItem = button.closest('.interval-item');
            intervalItem.remove();
            
            // Update revision count dropdown
            const currentCount = document.querySelectorAll('.interval-item').length;
            document.getElementById('revision-count').value = currentCount;
            
            // Reindex the remaining intervals
            const intervalNumbers = document.querySelectorAll('.interval-number');
            intervalNumbers.forEach((number, index) => {
                number.textContent = `R${index + 1}`;
            });
        }
        
        // Apply plan preset
        function applyPlanPreset() {
            const preset = document.getElementById('plan-preset').value;
            
            let intervals = [];
            
            switch(preset) {
                case 'default':
                    intervals = [1, 4, 7, 14, 28];
                    break;
                case 'intensive':
                    intervals = [1, 3, 7, 15, 30, 60];
                    break;
                case 'spaced':
                    intervals = [1, 7, 30, 90];
                    break;
                case 'fast':
                    intervals = [1, 2, 4, 7];
                    break;
                case 'custom':
                    // Keep current intervals
                    return;
            }
            
            // Update the UI
            document.getElementById('revision-count').value = intervals.length;
            
            // Clear and rebuild interval inputs
            const intervalsList = document.getElementById('intervals-list');
            intervalsList.innerHTML = '';
            
            intervals.forEach((interval, index) => {
                addIntervalInputElement(interval, index);
            });
            
            // Show notification
            showNotification(`Applied ${preset} preset`, 'success');
        }
        
        // Reset to default plan
        function resetToDefaultPlan() {
            currentRevisionPlan = [...DEFAULT_REVISION_PLAN];
            localStorage.removeItem('customRevisionPlan');
            
            // Update UI
            document.getElementById('revision-count').value = DEFAULT_REVISION_PLAN.length;
            document.getElementById('plan-preset').value = 'default';
            
            // Clear and rebuild interval inputs
            const intervalsList = document.getElementById('intervals-list');
            intervalsList.innerHTML = '';
            
            DEFAULT_REVISION_PLAN.forEach((interval, index) => {
                addIntervalInputElement(interval, index);
            });
            
            // Update current plan display
            updateCurrentPlanDisplay();
            
            showNotification('Reset to default revision plan', 'success');
        }
        
        // Update current plan display
        function updateCurrentPlanDisplay() {
            const title = document.getElementById('current-plan-title');
            const details = document.getElementById('current-plan-details');
            
            title.textContent = `Current Plan: ${currentRevisionPlan.length} Revisions`;
            details.innerHTML = '';
            
            currentRevisionPlan.forEach((interval, index) => {
                const detail = document.createElement('div');
                detail.className = 'plan-detail';
                detail.textContent = `R${index + 1}: Day ${interval}`;
                details.appendChild(detail);
            });
        }
        
        // Show date revisions in modal
        function showDateRevisions(date) {
            const modalContent = document.getElementById('modal-content');
            const revisions = revisionData.revisions.filter(rev => 
                rev.scheduledDate === date && !rev.isCompleted && !rev.isMissed
            );
            
            if (revisions.length === 0) {
                modalContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <p>No revisions scheduled for ${formatDateDisplay(date)}</p>
                    </div>
                `;
            } else {
                // Sort by subject and chapter name
                revisions.sort((a, b) => {
                    if (a.chapterSubject !== b.chapterSubject) {
                        return a.chapterSubject.localeCompare(b.chapterSubject);
                    }
                    return a.chapterName.localeCompare(b.chapterName);
                });
                
                let html = `
                    <div class="date-revision-list">
                        <div class="date-revision-item">
                            <div class="date-revision-header">
                                <div class="revision-date-title">${formatDateDisplay(date)}</div>
                                <div class="revision-count">${revisions.length} revision${revisions.length > 1 ? 's' : ''}</div>
                            </div>
                            <div class="date-chapters-list">
                `;
                
                revisions.forEach(rev => {
                    html += `
                        <div class="date-chapter-item">
                            <div>
                                <strong>${rev.chapterName}</strong>
                                <div style="font-size: 0.9rem; color: #666; margin-top: 3px;">
                                    <i class="fas fa-redo"></i> Revision R${rev.revisionNumber}/${currentRevisionPlan.length}
                                </div>
                            </div>
                            <span class="date-chapter-subject">${rev.chapterSubject.charAt(0).toUpperCase() + rev.chapterSubject.slice(1)}</span>
                        </div>
                    `;
                });
                
                html += `
                            </div>
                        </div>
                    </div>
                `;
                
                modalContent.innerHTML = html;
            }
            
            // Update modal title
            document.querySelector('#revision-plan-modal .modal-header h3').innerHTML = 
                `<i class="fas fa-calendar-week"></i> Revisions for ${formatDateDisplay(date)}`;
            
            // Show modal
            document.getElementById('revision-plan-modal').classList.add('active');
        }
        
        // Show all revision dates in modal
        function showAllRevisionDates() {
            const modalContent = document.getElementById('modal-content');
            const today = getToday();
            
            // Get all future revisions (not completed, not missed, and after today)
            const upcomingRevisions = revisionData.revisions.filter(rev => 
                rev.scheduledDate >= today && !rev.isCompleted && !rev.isMissed
            );
            
            if (upcomingRevisions.length === 0) {
                modalContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <p>No upcoming revisions scheduled!</p>
                        <p>Complete some chapters to see the revision schedule.</p>
                    </div>
                `;
            } else {
                // Group revisions by date
                const revisionsByDate = {};
                upcomingRevisions.forEach(rev => {
                    if (!revisionsByDate[rev.scheduledDate]) {
                        revisionsByDate[rev.scheduledDate] = [];
                    }
                    revisionsByDate[rev.scheduledDate].push(rev);
                });
                
                // Get dates and sort them
                const dates = Object.keys(revisionsByDate).sort();
                
                let html = `<div class="date-revision-list">`;
                
                dates.forEach(date => {
                    const revisions = revisionsByDate[date];
                    
                    html += `
                        <div class="date-revision-item" style="cursor: pointer;" onclick="showDateRevisions('${date}')">
                            <div class="date-revision-header">
                                <div class="revision-date-title">${formatDateDisplay(date)}</div>
                                <div class="revision-count">${revisions.length} revision${revisions.length > 1 ? 's' : ''}</div>
                            </div>
                            <div style="font-size: 0.9rem; color: #666;">
                                Click to view details
                            </div>
                        </div>
                    `;
                });
                
                html += `</div>`;
                
                modalContent.innerHTML = html;
            }
            
            // Update modal title
            document.querySelector('#revision-plan-modal .modal-header h3').innerHTML = 
                `<i class="fas fa-calendar-week"></i> All Upcoming Revision Dates`;
            
            // Show modal
            document.getElementById('revision-plan-modal').classList.add('active');
        }
        
        // Show notification
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>